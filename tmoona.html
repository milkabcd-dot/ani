<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>注 爪注 专 </title>
    <style>
        body { font-family: sans-serif; background: #121212; color: #e0e0e0; text-align: center; padding: 20px; }
        .main-container { max-width: 800px; margin: 0 auto; background: #1e1e1e; padding: 20px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        canvas { max-width: 100%; height: auto; border-radius: 10px; margin-top: 20px; display: none; }
        .controls { display: flex; justify-content: center; gap: 15px; margin: 20px 0; flex-wrap: wrap; }
        input, select, button { padding: 12px; border-radius: 8px; border: 1px solid #444; background: #2d2d2d; color: white; cursor: pointer; }
        button:hover { background: #404040; }
        .upload-label { font-weight: bold; display: block; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="main-container">
    <h2>К 住专 爪注 专 注</h2>
    <p>注 转. 注专转 转住 砖 转 爪注 转 拽住专 砖 拽.</p>

    <div class="controls">
        <div>
            <span class="upload-label">1. 专转 转</span>
            <input type="file" id="imageLoader" accept="image/*">
        </div>
        <div>
            <span class="upload-label">2. 住 专</span>
            <select id="patternType">
                <option value="wasp">爪-砖专 (驻住 )</option>
                <option value="ladybug">-砖专 (拽转 专)</option>
                <option value="monarch">转-砖专 (专/专拽)</option>
            </select>
        </div>
    </div>

    <canvas id="imageCanvas"></canvas>
</div>

<script>
    const imageLoader = document.getElementById('imageLoader');
    const canvas = document.getElementById('imageCanvas');
    const ctx = canvas.getContext('2d');
    const patternType = document.getElementById('patternType');

    let img = new Image();

    imageLoader.addEventListener('change', (e) => {
        const reader = new FileReader();
        reader.onload = (event) => {
            img.onload = () => {
                canvas.width = img.width;
                canvas.height = img.height;
                canvas.style.display = 'block';
                processImage();
            };
            img.src = event.target.result;
        };
        reader.readAsDataURL(e.target.files[0]);
    });

    patternType.addEventListener('change', processImage);

    function processImage() {
        if (!img.src) return;

        // 爪专 转 拽专转
        ctx.drawImage(img, 0, 0);

        // 砖驻转 转 驻拽住 注 注拽
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const data = imageData.data;

        const pattern = patternType.value;

        for (let i = 0; i < data.length; i += 4) {
            // 砖 专转 驻拽住 (Luminance)
            const r = data[i], g = data[i+1], b = data[i+2];
            const avg = (r + g + b) / 3;
            
            const x = (i / 4) % canvas.width;
            const y = Math.floor((i / 4) / canvas.width);

            // 爪专转 拽 砖砖转 转 爪注 专拽  砖 拽住专 转
            //    驻 "爪注" 注 住住 拽 专转
            let shouldColor = false;
            
            if (pattern === 'wasp') {
                // 驻住 住 砖转砖 专转 拽专转
                if ((x + y) % 100 < 50 && avg < 200) shouldColor = true;
                if (shouldColor) {
                    data[i] = 255;     // Red
                    data[i+1] = 204;   // Green
                    data[i+2] = 0;     // Blue
                }
            } else if (pattern === 'ladybug') {
                // 拽转 砖专转 注 专拽注 
                const dist = Math.sqrt(Math.pow(x % 100 - 50, 2) + Math.pow(y % 100 - 50, 2));
                if (dist < 20) {
                    data[i] *= 0.2; data[i+1] *= 0.2; data[i+2] *= 0.2; //  拽转
                } else {
                    data[i] = Math.max(data[i], 200); // 拽 
                }
            } else {
                // 转 注 砖转 拽 转专 (专)
                if (avg < 100) {
                    data[i] = 255; data[i+1] = 100; data[i+2] = 0;
                }
            }
        }

        ctx.putImageData(imageData, 0, 0);

        // 砖 住驻 - 砖 砖 转 拽专转 注 砖拽驻转  砖专 注 驻专
        ctx.globalAlpha = 0.4;
        ctx.globalCompositeOperation = 'multiply';
        ctx.drawImage(img, 0, 0);
        ctx.globalAlpha = 1.0;
        ctx.globalCompositeOperation = 'source-over';
    }
</script>

</body>
</html>
